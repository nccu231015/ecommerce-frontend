# 電商網站專案

這是一個完整的電子商務網站解決方案，包含前端客戶界面、後端 API 服務和管理員後台三個主要部分。

## 專案架構

```
Ecommerce Website/
├── frontend/       # 客戶端網站 (React)
├── backend/        # API 服務 (Express + MongoDB)
└── admin/          # 管理員後台 (React + Vite)
```

## 功能概述

### 🔄 AI 混合搜索 (核心特色)
- **語義增強混合搜索**: 使用 MongoDB 官方 Semantic Boosting 技術，結合向量語義搜索和全文搜索
- **智能分數增強**: 向量搜索的語義相似結果提升全文搜索的相關文檔分數
- **動態權重調整**: 根據查詢類型自動優化搜索策略
  - 品牌查詢: 全文搜索權重 70%
  - 描述性查詢: 向量搜索權重 70%
  - 預設平衡: 向量 60% + 全文 40%
- **相似度閾值過濾**: 設定 0.75 相似度閾值，確保高品質語義匹配
- **智能降級機制**: 混合搜索失敗時依序降級 (混合→向量→全文)
- **⭐ LLM 智能推薦**: GPT-4o 分析搜索結果，標記最符合需求的商品
- **精確匹配**: 點擊搜索建議進行精確匹配

### 🆕 相關商品推薦功能

#### **🎯 智能相關商品推薦**
- **多層推薦策略**: 向量相似度 → 類別標籤匹配 → 隨機精選
- **自動降級機制**: 確保始終有推薦商品顯示
- **視覺化標記**: 清晰標示推薦來源類型
- **無縫整合**: 商品詳情頁面底部自動顯示

#### **🧠 推薦算法詳解**
1. **向量相似度推薦** (優先級最高)
   - 使用商品向量嵌入計算語義相似度
   - 找出與當前商品在概念上最相似的其他商品
   - 排除當前正在查看的商品
   - 按相似度分數排序

2. **類別標籤匹配** (次優先級)
   - 當向量搜索不可用或失敗時啟用
   - 基於商品類別和標籤進行匹配
   - 智能評分: 類別匹配 +1 分，每個標籤匹配 +0.5 分
   - 按總匹配分數排序

3. **隨機精選推薦** (最後後備)
   - 當以上方法均無法提供足夠推薦時啟用
   - 從資料庫中隨機選取商品
   - 確保用戶體驗連續性

### 🧠 LLM 預處理混合搜索 (核心特色)

#### **🤖 智能查詢預處理系統**
- **自然語言理解**: GPT-4o 分析用戶意圖，提取核心關鍵詞
- **同義詞處理**: 智能處理「衣服」→「上衣/外套」等同義詞
- **查詢優化**: 移除無意義詞彙（給我、全部的、好看的）
- **多語言支持**: 中英文查詢處理

**預處理範例**：
```
「給我全部的外套」      → 「外套」
「黑色的運動外套」      → 「黑色 運動 外套」  
「PUMA的綠色連帽衫」    → 「PUMA 綠色 連帽」
「運動服」            → 「運動」
「綠色衣服」          → 「綠色」
```

### 前端功能
- 商品瀏覽和搜尋
- **🔄 AI 混合搜索頁面** (新增)
- 商品類別頁面 (男裝、女裝、兒童裝)
- 商品詳情頁面
- **🆕 相關商品推薦** (新增)
- 購物車功能
- 用戶註冊和登入
- 訂單管理

### 後端功能
- RESTful API
- **🤖 AI 搜索 API** (新增)
- **🆕 相關商品推薦 API** (新增)
- **向量化服務** (OpenAI Embeddings)
- 使用者認證 (JWT)
- 產品管理 API
- 購物車數據存儲
- 圖片上傳服務 (Cloudinary)

### 管理員後台
- 產品新增和管理
- **自動向量化**: 新產品上傳時自動生成向量
- 產品圖片上傳 (Cloudinary)
- 產品描述、類別、標籤管理
- 產品下架功能

## 技術棧

### 前端
- React 19
- React Router 7
- Context API (狀態管理)
- **AISearch 組件**: 混合搜索界面
- **RelatedProducts 組件**: 相關商品推薦

### 後端
- Express.js
- **MongoDB Atlas**: 雲端資料庫 + 向量搜索
- **SearchService**: AI 搜索邏輯封裝
- JWT (認證)
- Multer (檔案上傳)

### 管理員後台
- React 19
- Vite 6 (構建工具)
- React Router 7

## 快速開始

### 環境設定

#### 1. 設定環境變數
在 `backend/` 目錄下創建 `.env` 檔案：

```bash
# OpenAI API (AI 搜索必需)
OPENAI_API_KEY=sk-your-openai-key

# MongoDB Atlas (向量搜索必需)
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database

# Cloudinary (圖片存儲)
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret
```

#### 2. MongoDB Atlas 索引設定
在 MongoDB Atlas 中創建兩個搜索索引：
- **向量搜索索引**: `vector_index`
- **全文搜索索引**: `product_text_search`

### 本地開發

#### 1. 啟動後端服務

```bash
cd backend
npm install
node index.js
```

後端服務將在 http://localhost:4000 運行

#### 2. 啟動前端網站

```bash
cd frontend
npm install
npm start
```

前端將在 http://localhost:3000 運行

#### 3. 啟動管理員後台

```bash
cd admin
npm install
npm run dev
```

管理員後台將在 http://localhost:5173 運行

## 🚀 線上部署

### Vercel 部署連結
- **前端**: https://ecommerce-frontend-theta-mauve.vercel.app
- **後端**: https://ecommerce-backend-indol-xi.vercel.app
- **管理後台**: https://ecommerce-admin-amber.vercel.app

### 部署設定
詳細部署步驟請參考各子目錄的部署說明。

## 📋 環境需求

- Node.js 18+
- **MongoDB Atlas** (向量搜索支援)
- **OpenAI API Key** (AI 搜索功能)
- **Cloudinary 帳戶** (圖片存儲)
- 網路連線 (API 通訊)

## 🎯 最新更新

### v5.1.0 - 多關鍵詞智能搜索 (2025年1月) 🎉 [最新穩定版 - 用戶確認最成功]
- ✅ **用戶確認**：這是最成功的版本，搜索精度和靈活性最佳平衡
- 🔍 **多關鍵詞匹配**：從單一 phrase 改為多個 text 查詢，每個關鍵詞都必須匹配
- 🎯 **同義詞處理**：智能處理「衣服」→「上衣/外套」等同義詞關係
- ⚡ **修復搜索問題**：解決「黑色外套」「綠色衣服」等多詞查詢失敗問題
- 🧠 **LLM 預處理**：GPT-4o 智能分析查詢，提取核心關鍵詞
- 🔍 **語義增強**：向量搜索結果提升相關商品分數
- 🆕 **相關商品推薦**：新增商品詳情頁面相關商品推薦功能

### 用戶體驗優化

- 推薦徽章使用不同顏色和文字，清晰標識推薦來源
- 推薦商品點擊後自動滾動到頁面頂部
- 響應式設計，適配不同屏幕尺寸
- 加載狀態提示，減少用戶等待焦慮

### 使用方法

用戶無需執行任何操作，只要瀏覽任何商品詳情頁面，系統會自動顯示相關商品推薦。

### 開發者說明

相關商品推薦功能依賴後端 API，確保以下條件：

1. 環境變量 `REACT_APP_API_URL` 正確設置，或默認使用 `http://localhost:4000`
2. 後端服務已啟動並可訪問
3. MongoDB Atlas 向量索引已正確配置

---

**最新版本**: v5.1.0 + 相關商品推薦功能  
**最後更新**: 2025年1月